language: ruby
cache:
  - bundler
  - yarn
services:
  - postgresql
before_install:
  - nvm install --lts
before_script:
  - bundle install --jobs=3 --retry=3
  - yarn
  - cp config/database.yml.travis config/database.yml
  - bundle exec rake db:create
  - bundle exec rake db:schema:load
script:
  - bundle exec rake test

deploy:
  provider: heroku
  api_key:
    secure: B2UxOapQ45xdDRhSbF6HTPQo2M0pkh5bqIRi7Re1BM2WCgrh2iqA3uSfh+OTVrI49pUBzCyk3f5CGL+i9WFtYIXtMMRuRB42tiiaYev0btVtSxkx/0dxhVCynrfZdJUmyyceQfwIINgWEW20cP/qtpfMA8q1p0GZ9ABm+moas9GJ4Eh6IC4opxd+79kFLbUpp0EP4awWtKSi7h6kz/L1otUlYVMBFY7XbENb5HL+N81AAYUZ6WKwudQyP1eTEotGCfsnuI589hNvDUzZhrNU0JW17V7uKoTT/D4yflGAbXXFPBpuwaH0FTItE/ZZbQxnIjrnGDIYTdjTLIEu56JPUyEg5jbSAPHe3v4EtRq7ORHga04z29dEnig4zVLena9niXCW2f46nmiTzyGsSstiiL+c+ScjvCyoGaf8B6LHF01YXUyDUppyE7q5UsdJ0ZjnBIVRjdUrKpQS3KpC/OYwhmcKajmrP5Sw1i8SMvPqit0rP6ujbrMbiUviXyEqQOeHaRU03BL9wLQew1JBWTJ26TQePCe94CpA7n4MEK3V4+5u3Y89/3cBT6nxzYEUchEB1Us8t/OLqsp0ggMYmvwKTTVyL/jGCil0aE7L+hpnic51aHR0UWk4GEixm7Mp39o0QAj/EBVCmTQKw3d84YCsOXP3uk+U1DUMOHgvI1P+YYo=
  app: amitree-take-home-api
  on:
    repo: vshaddix/Amitree-take-home-api